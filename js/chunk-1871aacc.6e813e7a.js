(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1871aacc"],{6084:function(t,e,r){"use strict";var s=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("g",{staticClass:"hp-bar"},[r("rect",{attrs:{x:"2.91",y:"62.02",width:"77.18",height:"9.98"}}),r("rect",{staticClass:"primary-color",attrs:{x:"3",y:"64.55",width:"77.18",height:"7.45"}}),t._l(t.currentHPBars,(function(t){return r("rect",{key:t.id,attrs:{x:t.x,y:"64.79",width:"4.85",height:"6.88"}})}))],2)},n=[],a=(r("159b"),r("fb6a"),{name:"HealthStatus",data:function(){return{bars:[{id:1,x:"4.44"},{id:2,x:"12.11"},{id:3,x:"19.78"},{id:4,x:"27.44"},{id:5,x:"35.11"},{id:6,x:"42.77"},{id:7,x:"50.44"},{id:8,x:"58.11"},{id:9,x:"65.77"},{id:10,x:"73.44"}],currentHPBars:[]}},mounted:function(){this.currentHPBars=this.bars},methods:{updateHealth:function(t,e){var r=0;e.length>0&&e.forEach((function(t){r+=t.value}));var s=(parseInt(t)+parseInt(r))/t;if(s>0&&s<1){var n=Math.round(s*t),a=n-1;this.currentHPBars=this.bars.slice(0,a)}else 1==s?this.currentHPBars=this.bars:s<=0&&(this.currentHPBars=[])},getHealth:function(){return this.currentHPBars.length}}}),i=a,c=r("2877"),o=Object(c["a"])(i,s,n,!1,null,"f4ed2c24",null);e["a"]=o.exports},"6ea9":function(t,e,r){"use strict";r("b15d")},b15d:function(t,e,r){},f544:function(t,e,r){"use strict";r.r(e);var s=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("g",[r("svg",{attrs:{viewBox:"0 0 83 75",width:"83",height:"75",x:"48.05",y:"64.94"}},[r("rect",{attrs:{width:"83",height:"75",rx:"3.01",ry:"3.01"}}),"ai"===this.battleType&&null!==this.currentCharacter&&"player"!==this.currentCharacter.type?r("g",{domProps:{innerHTML:t._s(this.screenContent)}}):t._e(),"ai"===this.battleType&&null!==this.currentCharacter&&"player"===this.currentCharacter.type?r("g",{staticClass:"flip",domProps:{innerHTML:t._s(this.screenContent)}}):t._e(),"ai"!==this.battleType&&null!==this.currentCharacter?r("g",{staticClass:"standby-face-right",class:{flip:t.currentCharacter.sessionId!==this.sessionId},domProps:{innerHTML:t._s(this.screenContent)}}):t._e(),r("health-status",{ref:"hpBar"})],1)])},n=[],a=r("5530"),i=(r("159b"),r("9e85")),c=r("2f62"),o=r("6084"),h={name:"BattleChooseWinner",components:{HealthStatus:o["a"]},data:function(){return{currentCharacter:null,screenContent:""}},computed:Object(a["a"])(Object(a["a"])({},Object(c["c"])({turnType:function(t){return t.battle.turnType},battleType:function(t){return t.battle.type},enemy:function(t){return t.battle.enemy},player:function(t){return t.battle.player},currentTurn:function(t){return t.battle.currentTurn},deviceType:function(t){return t.session.deviceType},sessionId:function(t){return t.session.id}})),Object(c["b"])({enemyDamageActions:"battle/getAllEnemyDamageActions",playerHPActions:"battle/getAllPlayerHPActions"})),mounted:function(){this.battleType===i["b"].AI?(this.turnType===i["k"].Attack?(this.currentCharacter=this.player,this.createUI()):(this.currentCharacter=this.enemy,this.createUI()),this.startAnim(this.player,this.enemy)):(this.currentCharacter=this.player,this.createUI(),this.$socket.client.emit("getPlayersStatus",this.$store.state.battle.id))},methods:{createHPBars:function(t){this.$refs.hpBar&&this.$refs.hpBar.updateHealth(t.hp,this.getDamage(t))},startAnim:function(t,e){var r=this,s=750,n=4e3,a=null;a=setInterval((function(){n<=0?(clearInterval(a),r.chooseWinner(t,e)):n>0&&(r.battleType===i["b"].AI?r.currentCharacter.type===t.type?r.currentCharacter=e:r.currentCharacter=t:r.currentCharacter.sessionId===t.sessionId?r.currentCharacter=e:r.currentCharacter=t,r.createUI(),n-=s)}),s)},chooseWinner:function(t,e){this.calculateTotalHP(t)>this.calculateTotalHP(e)?this.currentCharacter=t:this.currentCharacter=e;var r="";this.createUI(),this.battleType===i["b"].AI?this.currentCharacter.type===i["g"].Player?(r=i["j"].BattleWinner,this.$store.commit("session/levelup"),this.enemy.type===i["g"].Virus?this.$store.dispatch("session/stageClear"):this.enemy.type===i["g"].Boss&&this.$store.dispatch("session/stageComplete")):(r=i["j"].BattleLoser,this.currentCharacter.type===i["g"].Boss?this.$store.commit("session/decrementStageClear",10):this.$store.commit("session/decrementNaviRecovery",100)):(this.currentCharacter.sessionId===this.$store.state.session.id?(this.$store.commit("session/incrementWins"),r=i["j"].BattleWinner):(this.$store.commit("session/incrementLosses"),r=i["j"].BattleLoser),this.$socket.client.emit("endBattle",this.$store.state.battle.id)),this.$store.commit("session/setCurrentScene",r)},importRightFace:function(){this.screenContent=r("f757")("./".concat(this.deviceType.toLowerCase(),"/attack-face.svg"))},importVirus:function(){this.screenContent=r("e70d")("./".concat(this.enemy.image))},importBoss:function(){this.screenContent=r("233c")("./".concat(this.enemy.image))},createUI:function(){this.currentCharacter.type===i["g"].Player?this.importRightFace():this.currentCharacter.type===i["g"].Virus?this.importVirus():this.importBoss(),this.createHPBars(this.currentCharacter)},calculateTotalHP:function(t){var e=0,r=this.getDamage(t);return r.forEach((function(t){e+=t.value})),t.hp+e},getDamage:function(t){var e=[];return e=t.type===i["g"].Player&&t.sessionId===this.sessionId?this.playerHPActions:this.enemyDamageActions,e}},sockets:{playersStatus:function(){this.startAnim(this.player,this.enemy)}}},u=h,l=(r("6ea9"),r("2877")),p=Object(l["a"])(u,s,n,!1,null,"652be36d",null);e["default"]=p.exports},f757:function(t,e,r){var s={"./bass/attack-face.svg":"30b9","./megaman/attack-face.svg":"2286","./protoman/attack-face.svg":"6384"};function n(t){var e=a(t);return r(e)}function a(t){if(!r.o(s,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return s[t]}n.keys=function(){return Object.keys(s)},n.resolve=a,t.exports=n,n.id="f757"},fb6a:function(t,e,r){"use strict";var s=r("23e7"),n=r("861d"),a=r("e8b5"),i=r("23cb"),c=r("50c4"),o=r("fc6a"),h=r("8418"),u=r("b622"),l=r("1dde"),p=l("slice"),d=u("species"),f=[].slice,y=Math.max;s({target:"Array",proto:!0,forced:!p},{slice:function(t,e){var r,s,u,l=o(this),p=c(l.length),m=i(t,p),g=i(void 0===e?p:e,p);if(a(l)&&(r=l.constructor,"function"!=typeof r||r!==Array&&!a(r.prototype)?n(r)&&(r=r[d],null===r&&(r=void 0)):r=void 0,r===Array||void 0===r))return f.call(l,m,g);for(s=new(void 0===r?Array:r)(y(g-m,0)),u=0;m<g;m++,u++)m in l&&h(s,u,l[m]);return s.length=u,s}})}}]);
//# sourceMappingURL=chunk-1871aacc.6e813e7a.js.map